!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(a){return a}function c(a){a.on("change.datepair",null,e)}function d(a){a.off("change.datepair")}function e(b){var e=a(this);d(e);var f=e.data("datepair-settings"),g=a(b.target);g.hasClass(f.dateClass)?""!=g.val()?j(e,g):e.data("datepair-datedelta",null):g.hasClass(f.timeClass)&&(""!=g.val()?l(e,g):e.data("datepair-timedelta",null)),m(e),k(e),c(e)}function f(a){var b=a.data("datepair-settings");return a.find("."+b.startClass+"."+b.dateClass)}function g(a){var b=a.data("datepair-settings");return a.find("."+b.endClass+"."+b.dateClass)}function h(a){var b=a.data("datepair-settings");return a.find("."+b.startClass+"."+b.timeClass)}function i(a){var b=a.data("datepair-settings");return a.find("."+b.endClass+"."+b.timeClass)}function j(a,b){var c=a.data("datepair-settings"),d=f(a),e=g(a);if(d.length&&e.length)if(d.val()&&e.val()){var h=c.parseDate(d),i=c.parseDate(e);if(b.hasClass(c.startClass)){var j=new Date(h.getTime()+a.data("datepair-datedelta"));c.updateDate(e,j)}else b.hasClass(c.endClass)&&(h>i?(a.data("datepair-datedelta",0),c.updateDate(d,i)):a.data("datepair-datedelta",i.getTime()-h.getTime()))}else if(null!==c.defaultDateDelta){if(d.val()){var h=c.parseDate(d),k=new Date(h.getTime()+c.defaultDateDelta*n);c.updateDate(e,k)}else if(e.val()){var i=c.parseDate(e),l=new Date(i.getTime()-c.defaultDateDelta*n);c.updateDate(d,l)}a.data("datepair-datedelta",c.defaultDateDelta*n)}else a.data("datepair-datedelta",null)}function k(a){var b=a.data("datepair-settings");if("function"==typeof b.setMinTime){var c=null;if(!a.data("datepair-datedelta")||a.data("datepair-datedelta")<n||a.data("datepair-timedelta")&&a.data("datepair-datedelta")+a.data("datepair-timedelta")<n){var d=h(a);c=b.parseTime(d)}var e=i(a);b.setMinTime(e,c)}}function l(a,b){var c=a.data("datepair-settings"),d=h(a),e=i(a);if(d.length&&e.length)if(d.val()&&e.val()){var f=c.parseTime(d),k=c.parseTime(e);if(b.hasClass(c.startClass)){var l=new Date(f.getTime()+a.data("datepair-timedelta"));c.updateTime(e,l),k=c.parseTime(e)}if((k.getTime()-f.getTime())*a.data("datepair-timedelta")<0){var m=g(a);if(m.val()){var o=f>k?n:-1*n,p=c.parseDate(m);c.updateDate(m,new Date(p.getTime()+o)),j(a,m)}}a.data("datepair-timedelta",k.getTime()-f.getTime())}else if(null!==c.defaultTimeDelta){if(d.val()){var f=c.parseTime(d),q=new Date(f.getTime()+c.defaultTimeDelta);c.updateTime(e,q)}else if(e.val()){var k=c.parseTime(e),r=new Date(k.getTime()-c.defaultTimeDelta);c.updateTime(d,r)}a.data("datepair-timedelta",c.defaultTimeDelta)}else a.data("datepair-timedelta",null)}function m(a){var b=h(a),c=i(a);if(b.length&&c.length&&null===a.data("datepair-timedelta"))return void a.trigger("rangeIncomplete");var d=f(a),e=g(a);return d.length&&e.length&&null===a.data("datepair-datedelta")?void a.trigger("rangeIncomplete"):void a.trigger(a.data("datepair-datedelta")+a.data("datepair-timedelta")>=0?"rangeSelected":"rangeError")}var n=864e5,o={startClass:"start",endClass:"end",timeClass:"time",dateClass:"date",defaultDateDelta:0,defaultTimeDelta:36e5,parseTime:function(a){return a.timepicker("getTime")},updateTime:function(a,b){a.timepicker("setTime",b)},parseDate:function(a){return a.datepicker("getDate")},updateDate:function(a,b){a.datepicker("update",b)},setMinTime:function(a,b){a.timepicker("option","minTime",b)}},p={init:function(d){return this.each(function(){var e=a(this),j=a.extend({},o);d&&(j=a.extend(j,d)),j=b(j),e.data("datepair-settings",j),c(e);var l=f(e),m=g(e);if(l.val()&&m.val()){var n=j.parseDate(l),p=j.parseDate(m);e.data("datepair-datedelta",p.getTime()-n.getTime())}else e.data("datepair-datedelta",null);var q=h(e),r=i(e);if(q.val()&&r.val()){var s=j.parseTime(q),t=j.parseTime(r);e.data("datepair-timedelta",t.getTime()-s.getTime())}else e.data("datepair-timedelta",null);k(e)})},option:function(c,d){var e=this,f=e.data("datepair-settings");if("object"==typeof c)f=a.extend(f,c);else if("string"==typeof c&&"undefined"!=typeof d)f[c]=d;else if("string"==typeof c)return f[c];return f=b(f),e.data("datepair-settings",f),e},getTimeDiff:function(){return $self=this,$self.data("datepair-datedelta")*n+$self.data("datepair-timedelta")},remove:function(){var a=this;return a.removeData("datepair-settings"),d(a),a}};a.fn.datepair=function(b){return p[b]?p[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.datepair"):p.init.apply(this,arguments)}});