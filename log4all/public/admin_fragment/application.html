<div ng-controller="ApplicationController">
    <div class="ui segment" style="min-height:500px;">
        <h2 class="ui header">Edit Application : {[{application.name}]}</h2>
        <div class="ui top attached tabular menu">
            <a class="ui active item" data-tab="generalTab"><i class="ui rocket icon"></i>General</a>
            <a class="ui item" data-tab="retentionTab"><i class="ui archive icon"></i>Retention</a>
            <a class="ui item" data-tab="permissionTab"><i class="ui user icon"></i>Permissions</a>
        </div>
        <div class="ui bottom attached active tab segment" data-tab="generalTab">
            <div class="ui form">
                <div class="field">
                    <label>Name</label>
                    <input type="text" ng-model="application.name"/>
                </div>
                <div class="field">
                    <label>Description</label>
                    <input type="text" ng-model="application.description"/>
                </div>
                <div class="field">
                    <label>Token</label>
                    <input type="text" ng-model="application.token"/>
                </div>
                <div class="inline field">
                    <label>Safe writing</label>
                    <input type="checkbox" ng-model="application.configuration.writeSafe"/>
                </div>
            </div>
        </div>
        <div class="ui bottom attached tab segment" data-tab="retentionTab">
            <div class="ui buttons">
                <div class="ui button" ng-class="{green:currentConfigurationLevel=='debug'}"
                     ng-click="changeConfiguration('debug')">Debug
                </div>
                <div class="ui button" ng-class="{blue:currentConfigurationLevel=='info'}"
                     ng-click="changeConfiguration('info')">Info
                </div>
                <div class="ui button" ng-class="{orange:currentConfigurationLevel=='warning'}"
                     ng-click="changeConfiguration('warning')">Warning
                </div>
                <div class="ui button" ng-class="{red:currentConfigurationLevel=='error'}"
                     ng-click="changeConfiguration('error')">Error
                </div>
            </div>
            <div class="ui bottom attached segment form">
                <div class="field">
                    <label>Archive after (days)</label>
                    <input type="number" ng-model="currentConfiguration.archive"/>
                </div>
                <div class="field">
                    <label>Delete after (days)</label>
                    <input type="number" ng-model="currentConfiguration.delete"/>
                </div>
            </div>
        </div>
        <div class="ui bottom attached tab segment" data-tab="permissionTab">
            <table class="ui table">
                <thead>
                    <tr>
                        <th>User</th>
                        <th>Permission<th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="applicationUser in application.permissions">
                        <td>
                            {[{applicationUser.username}]}
                        </td>
                        <td>
                            {[{applicationUser.permission}]}
                        </td>
                        <td>
                            <div class="ui icon button" ng-click="removeUserPermission($index)"><i class="ui remove red icon"></i></div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <h3 class="ui header">Add User</h3>
            <form class="ui form">
                <div class="two fields">
                    <div class="field">
                        <label>Username</label>
                        <input type="text" ng-model="newAppPermission.username"/>
                    </div>
                    <div class="field">
                        <label>Permission</label>
                        <select ng-model="newAppPermission.permission">
                            <option value="manager">Manager</option>
                            <option value="administrator">Administrator</option>
                        </select>
                    </div>
                </div>
                <div class="ui icon button" ng-click="addUserPermission()"><i class="ui plus icon"></i>Add User</div>
            </form>
        </div>
        <script type="text/javascript">
            $('.menu .item').tab();
        </script>
    </div>
    <div class="ui segment attached grid">
            <div class="fourteen wide column">
                <div class="ui message animate-hide" ng-class="{negative:!result.success,positive:result.success}" ng-hide="result.message == null">{[{ result.message }]}</div>
            </div>
            <div class="two wide column right aligned"><div class="ui green icon button" ng-click="updateApplication()"><i class="ui save icon"></i>Save</div></div>
    </div>
</div>